# This file contains blocks from The Fallen Eagle files that can be replaced with new ones.
# The structure is as follows:

# <file name> = {
# 	replace = {
# 		before = {
# 			some original code			
# 		}
# 		after = {
# 			some modified code			
# 		}
# 	}
#
# 	replace = {
# 		before = {
# 			some original code 2		
# 		}
# 		after = {
# 			some modified code 2		
# 		}
# 	}
# }

# INDENTATION IS IMPORTANT INSIDE the before BLOCK!
# ASIDE FROM THE CURLY BRACKETS SURROUNDING THE BLOCK, IT MUST MATCH THE ORIGINAL FILE.
# OTHERWISE THE BLOCKS WON'T BE MODIFIED!


"common/scripted_triggers/tfe_culture_triggers.txt" = {
	replace = {
		before = {
	any_county = {
		limit = {
			title_province = {
				geographical_region = custom_england
			}
		}
		count >= 6
		holder = {
			OR = {
				this = scope:valid_opponent
				any_liege_or_above = { this = scope:valid_opponent }
			}
		}
	}
		} # end of before

		after = {
	any_county = {
		count >= 6
		title_province = {
			geographical_region = custom_england
		}
		holder = {
			OR = {
				this = scope:valid_opponent
				any_liege_or_above = { this = scope:valid_opponent }
			}
		}
	}
		} # end of after
	}
}


"common/culture/pillars/TFE_language.txt" = {
	replace = {
		before = {
			limit = { has_cultural_pillar = languaglanguage_west_himalayane_pyu }
		}
		after = {
			limit = { has_cultural_pillar = language_west_himalayan }
		}
	}
}


"map_data/geographical_regions/geographical_region.txt" = {
	# No c_reggio in TFE as of the 'After The Pharaohs' update.
	replace = {
		before = {
		c_reggio
		c_camarda
		}
		after = {
		c_camarda
		}
	}

	# No c_san in TFE as of the 'After The Pharaohs' update.
	replace = {
		before = {
		c_san
		c_parma
		}
		after = {
		c_parma
		}
	}

	# No c_sankt in TFE as of the 'After The Pharaohs' update.
	replace = {
		before = {
		c_sankt
		c_zurich
		}
		after = {
		c_zurich
		}
	}

	# No c_sankt in TFE as of the 'After The Pharaohs' update.
	replace = {
		before = {
		c_sankt
		c_amstetten
		}
		after = {
		c_amstetten
		}
	}

	# No c_french in TFE as of the 'After The Pharaohs' update.
	replace = {
		before = {
		c_french
		c_penthievre
		}
		after = {
		c_penthievre
		}
	}

	# No c_ile in TFE as of the 'After The Pharaohs' update.
	# No c_brie in TFE as of the 'After The Pharaohs' update.
	replace = {
		before = {
		c_ile
		c_brie
		}
		after = {
		}
	}

	# No c_west in TFE as of the 'After The Pharaohs' update.
	replace = {
		before = {
		c_west
		c_mahdiya
		}
		after = {
		c_mahdiya
		}
	}

	# No c_alcacer in TFE as of the 'After The Pharaohs' update.
	replace = {
		before = {
		c_alcacer
		c_alcacer_do_sal
		}
		after = {
		c_alcacer_do_sal
		}
	}

	# No c_asturias in TFE as of the 'After The Pharaohs' update.
	replace = {
		before = {
		c_asturias
		c_asturias_de_santillana
		}
		after = {
		c_asturias_de_santillana
		}
	}

	# No c_alto in TFE as of the 'After The Pharaohs' update.
	replace = {
		before = {
		c_alto
		c_alto_aragon
		}
		after = {
		c_alto_aragon
		}
	}

	# No c_castelo in TFE as of the 'After The Pharaohs' update.
	replace = {
		before = {
		c_castelo
		c_castelo_branco
		}
		after = {
		c_castelo_branco
		}
	}
}


"events/TFE_flavour_events.txt" = {
	# from error.log as of TFE 'After The Pharaohs' update
	# [01:35:44][E][jomini_script_system.cpp:284]: Script system error!
	#  Error: death effect [ Unknown death reason 'sickness' ]
	#  Script location: file: events/TFE_flavour_events.txt line: 1700 (TFE_flavour_events.0039:immediate)
	replace = {
		before = {
				death_reason = sickness
		}
		after = {
				death_reason = death_ill
		}
	}
}


"music/main_themes/music.txt" = {
	# Restore vanilla main theme, the TFE one seems broken as of the 'After The Pharaohs' update.
	replace = {
		before = {
main_theme_track = {
	music = "file:/MUSIC/TFE/TFE_Main.ogg"
	name = "TFE_main_theme_track"
	can_be_interrupted = yes
}
		}
		after = {
main_theme_track = {
	music = "event:/MUSIC/MainTheme/Maintheme"
	can_be_interrupted = yes
}
		}
	}
}


"common/culture/traditions/TFE_realm_traditions.txt" = {
	# from error.log:
	# [02:52:37][E][pdx_persistent_reader.cpp:216]: Error: "Unexpected token: strong_traits_more_valued, near line: 473" in file: "common/culture/traditions/TFE_realm_traditions.txt" near line: 473
	# [02:52:37][E][pdx_persistent_reader.cpp:216]: Error: "Unexpected token: strong_traits_more_common, near line: 474" in file: "common/culture/traditions/TFE_realm_traditions.txt" near line: 474
	# [02:52:37][E][pdx_persistent_reader.cpp:216]: Error: "Unexpected token: weak_traits_looked_down_upon, near line: 475" in file: "common/culture/traditions/TFE_realm_traditions.txt" near line: 475
	replace = {
		before = {
	character_modifier = {
		strong_traits_more_valued = yes
		strong_traits_more_common = yes
		weak_traits_looked_down_upon = yes
		accolade_glory_gain_mult = 0.1
		light_cavalry_max_size_add = 2
	}
		}
		after = {
	character_modifier = {
		accolade_glory_gain_mult = 0.1
		light_cavalry_max_size_add = 2
	}
		}
	}
}


"history/cultures/heritage_hellenistic.txt" = {
	# from error.log: "key reference innovation_animal_husbandry found more that one time"
	replace = {
		before = {
	discover_innovation = innovation_animal_husbandry
	discover_innovation = innovation_tanning_tables
	discover_innovation = innovation_animal_husbandry
		}
		after = {
	discover_innovation = innovation_animal_husbandry
	discover_innovation = innovation_tanning_tables
		}
	}
}


"history/cultures/heritage_iberian.txt" = {
	# from error.log:
	# [03:32:02][E][culture_history_entry.cpp:42]: key reference innovation_mustering_grounds found more that one time file: history/cultures/heritage_iberian.txt line: 43
	# [03:32:02][E][culture_history_entry.cpp:42]: key reference innovation_development_01 found more that one time file: history/cultures/heritage_iberian.txt line: 44
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
		}
	}
}


"history/cultures/afro_roman.txt" = {
	# from error.log:
	# [03:32:01][E][culture_history_entry.cpp:42]: key reference innovation_crop_rotation found more that one time file: history/cultures/afro_roman.txt line: 36
	replace = {
		before = {
	discover_innovation = innovation_smithing_tables
	discover_innovation = innovation_crop_rotation
		}
		after = {
	discover_innovation = innovation_smithing_tables
		}
	}

	# from error.log:
	# [03:32:01][E][culture_history_entry.cpp:42]: key reference innovation_mustering_grounds found more that one time file: history/cultures/afro_roman.txt line: 38
	# [03:32:01][E][culture_history_entry.cpp:42]: key reference innovation_development_01 found more that one time file: history/cultures/afro_roman.txt line: 39
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {}
	}
}


"history/cultures/daylamite.txt" = {
	# from error.log:
	# key reference innovation_development_01 found more that one time file: history/cultures/daylamite.txt line: 30
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"history/cultures/egyptian.txt" = {
	# from error.log: key reference innovation_development_01 found more that one time file: history/cultures/egyptian.txt line: 32
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"history/cultures/georgian.txt" = {
	replace = {
		before = {
	discover_innovation = innovation_animal_husbandry
	discover_innovation = innovation_tanning_tables
	discover_innovation = innovation_animal_husbandry
		}
		after = {
	discover_innovation = innovation_animal_husbandry
	discover_innovation = innovation_tanning_tables
		}
	}
}


"history/cultures/heritage_byzantine.txt" = {
	replace = {
		before = {
	discover_innovation = innovation_animal_husbandry
	discover_innovation = innovation_tanning_tables
	discover_innovation = innovation_animal_husbandry
		}
		after = {
	discover_innovation = innovation_animal_husbandry
	discover_innovation = innovation_tanning_tables
		}
	}
}


"history/cultures/heritage_dravidian.txt" = {
	# from error.log: "key reference innovation_development_01 found more that one time file: history/cultures/heritage_dravidian.txt line: 34"
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"history/cultures/heritage_indo_aryan.txt" = {
	# from error.log: "key reference innovation_development_01 found more that one time file: history/cultures/heritage_indo_aryan.txt line: 34"
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"common/on_action/TFE_game_start.txt" = {
	# backport of TFE commit 7dfdda5
	replace = {
		before = {
				OR = {
					government_allows = administrative
					top_liege = { government_allows = administrative }
				}
		}
		after = {
				government_allows = administrative
				top_liege = { government_allows = administrative }
		}
	}
}


"common/court_positions/types/missonary_court_positions.txt" = {
	# from error.log:
	# [04:13:22][E][jomini_script_system.cpp:284]: Script system error!
	#  Error: has_doctrine_parameter trigger [ Bool doctrine parameter 'doctrine_missionary_encouraged' does not exist ]
	#  Script location: file: common/court_positions/types/missonary_court_positions.txt line: 244 (missionary:aptitude)
	replace = {
		before = {
					has_doctrine_parameter = doctrine_missionary_encouraged
		}
		after = {
					has_doctrine = doctrine_missionary_encouraged
		}
	}
}


"history/cultures/heritage_iranian.txt" = {
	# from error.log:
	# key reference innovation_development_01 found more that one time file: history/cultures/heritage_iranian.txt line: 31
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"history/cultures/heritage_israelite.txt" = {
	# from error.log:
	# key reference innovation_development_01 found more that one time file: history/cultures/heritage_israelite.txt line: 28
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"history/cultures/heritage_kemetic.txt" = {
	# from error.log:
	# key reference innovation_development_01 found more that one time file: history/cultures/heritage_kemetic.txt line: 32
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"history/cultures/yemeni.txt" = {
	# from error.log:
	# key reference innovation_development_01 found more that one time file: history/cultures/yemeni.txt line: 32
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"history/cultures/radhanite.txt" = {
	# from error.log:
	# key reference innovation_development_01 found more that one time file: history/cultures/radhanite.txt line: 28
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"history/cultures/kashmiri.txt" = {
	# from error.log:
	# key reference innovation_development_01 found more that one time file: history/cultures/kashmiri.txt line: 34
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"history/cultures/heritage_levantine.txt" = {
	# from error.log:
	# key reference innovation_development_01 found more that one time file: history/cultures/heritage_levantine.txt line: 32
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"history/cultures/kochinim.txt" = {
	# from error.log:
	# key reference innovation_development_01 found more that one time file: history/cultures/kochinim.txt line: 34
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"history/cultures/nepali.txt" = {
	# from error.log:
	# key reference innovation_development_01 found more that one time file: history/cultures/nepali.txt line: 34
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {
	discover_innovation = innovation_mustering_grounds
		}
	}
}


"history/cultures/mauro_roman.txt" = {
	# from error.log:
	# key reference innovation_crop_rotation found more that one time file: history/cultures/mauro_roman.txt line: 36
	replace = {
		before = {
	discover_innovation = innovation_smithing_tables
	discover_innovation = innovation_crop_rotation
		}
		after = {
	discover_innovation = innovation_smithing_tables
		}
	}

	# from error.log:
	# key reference innovation_mustering_grounds found more that one time file: history/cultures/mauro_roman.txt line: 38
	# key reference innovation_development_01 found more that one time file: history/cultures/mauro_roman.txt line: 39
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {}
	}
}

"history/cultures/heritage_latin.txt" = {
	# from error.log:
	# key reference innovation_crop_rotation found more that one time file: history/cultures/heritage_latin.txt line: 36
	replace = {
		before = {
	discover_innovation = innovation_smithing_tables
	discover_innovation = innovation_crop_rotation
		}
		after = {
	discover_innovation = innovation_smithing_tables
		}
	}

	# from error.log:
	# key reference innovation_mustering_grounds found more that one time file: history/cultures/heritage_latin.txt line: 38
	# key reference innovation_development_01 found more that one time file: history/cultures/heritage_latin.txt line: 39
	replace = {
		before = {
	discover_innovation = innovation_mustering_grounds
	discover_innovation = innovation_development_01
		}
		after = {}
	}
}


"common/religion/religions/00_zoroastrianism.txt" = {
	# from ck3-tiger: "title armaz not defined in common/landed_titles/"
	# Remove religious_head entry and set doctrine_no_head.
	replace = {
		before = {
		armaz = {
			color = { 0.1 0.7 0.4 }
			icon = georgian_zoroastrian
			reformed_icon = georgian_zoroastrian_reformed
			religious_head = armaz

			holy_site = ushi-darena
			holy_site = nok_kundi
			holy_site = takht-i-sangin
			holy_site = takht-e_soleyman
			holy_site = yazd

			doctrine = tenet_unrelenting_faith
			doctrine = tenet_ancestor_worship
			doctrine = tenet_sacrificial_ceremonies
			doctrine = doctrine_major_branch_behdin 

			doctrine = doctrine_pluralism_pluralistic
			doctrine = doctrine_spiritual_head
			doctrine = unreformed_faith_doctrine

			localization = {
				HighGodName = urartuism_high_god_name
				HighGodName2 = urartuism_high_god_name_2
				HighGodNamePossessive = urartuism_high_god_name_possessive
				GoodGodNames = {
					urartu_good_god_vanatur
					urartu_good_god_the_sun
					urartu_good_god_mithra
					urartu_good_god_zoroaster
				}
				PriestMale = urartuism_priest_male
				PriestMalePlural = urartuism_priest_male_plural
				PriestFemale = urartuism_priest_male
				PriestFemalePlural = urartuism_priest_male_plural
				PriestNeuter = urartuism_priest_male
				PriestNeuterPlural = urartuism_priest_male_plural
			}
		}
		}
		after = {
		armaz = {
			color = { 0.1 0.7 0.4 }
			icon = georgian_zoroastrian
			reformed_icon = georgian_zoroastrian_reformed

			holy_site = ushi-darena
			holy_site = nok_kundi
			holy_site = takht-i-sangin
			holy_site = takht-e_soleyman
			holy_site = yazd

			doctrine = tenet_unrelenting_faith
			doctrine = tenet_ancestor_worship
			doctrine = tenet_sacrificial_ceremonies
			doctrine = doctrine_major_branch_behdin 

			doctrine = doctrine_pluralism_pluralistic
			doctrine = doctrine_no_head
			doctrine = unreformed_faith_doctrine

			localization = {
				HighGodName = urartuism_high_god_name
				HighGodName2 = urartuism_high_god_name_2
				HighGodNamePossessive = urartuism_high_god_name_possessive
				GoodGodNames = {
					urartu_good_god_vanatur
					urartu_good_god_the_sun
					urartu_good_god_mithra
					urartu_good_god_zoroaster
				}
				PriestMale = urartuism_priest_male
				PriestMalePlural = urartuism_priest_male_plural
				PriestFemale = urartuism_priest_male
				PriestFemalePlural = urartuism_priest_male_plural
				PriestNeuter = urartuism_priest_male
				PriestNeuterPlural = urartuism_priest_male_plural
			}
		}
		}
	}
}