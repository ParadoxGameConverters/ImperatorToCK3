# This file contains blocks from on_action files that can be removed.
# The structure is as follows:

# <file name> = {
# 	{
#          <block 1>
#   },
# 	{
#     <block 2 
# 	    as a multiline examle>
#   },
# }

# INDENTATION IS IMPORTANT!
# ASIDE FROM THE CURLY BRACKETS SURROUNDING THE BLOCK, IT MUST MATCH THE ORIGINAL ON-ACTION FILE.
# OTHERWISE THE BLOCK WON'T BE REMOVED!

"yearly_on_actions.txt" = {
	{
			# FP2 - Checks to start El Cid's Travels
			if = {
				limit = { # Am I El Cid?
					this = character:107590
					NOT = { has_character_flag = has_already_begun_travelling } # Separate first check, for performance

					NOT = { # Start date employer is either dead or gone
						OR = {
							top_liege = character:107500
							liege = character:107500
							employer = character:107500
						}
					}
					is_available_healthy_ai_adult = yes # Am I ready to go on an adventure?
				}
				trigger_event = fp2_struggle.2045
			}
	}
}

"death.txt" = {
	{
		# Fix gods-damned Bavaria splitting from East Francia in an ugly fashion in 867.
		if = {
			limit = {
				# Make sure we're looking at the right guy & that the circumstances haven't changed too much.
				this = character:90107
				highest_held_title_tier = tier_kingdom
				has_realm_law = confederate_partition_succession_law
				# Bavaria should be in a fit state for interfering with the handout order.
				title:k_bavaria = {
					OR = {
						is_title_created = no
						holder = root
					}
					any_in_de_jure_hierarchy = {
						tier = tier_county
						# More than 50%.
						count >= 22
						holder = {
							any_liege_or_above = { this = root }
						}
					}
				}
				NOT = { has_primary_title = title:k_bavaria }
				# Players can sort this themselves: you just need to have Bavaria as your primary title and it's all fine.
				is_ai = yes
			}
			# If we've got no Bavaria, create it.
			if = {
				limit = {
					title:k_bavaria = { is_title_created = no }
				}
				create_title_and_vassal_change = {
					type = created
					save_scope_as = change
				}
				title:k_bavaria = {
					change_title_holder = {
						holder = root
						change = scope:change
					}
				}
				resolve_title_and_vassal_change = scope:change
			}
			# Then switch around.
			set_primary_title_to = title:k_bavaria
		}
	}
}